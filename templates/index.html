<!DOCTYPE html>
<html dir="rtl" lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…ØµÙ†Ù Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ø°ÙƒÙŠ (MNIST)</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        body { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 20px; color: #333; }
        .container { max-width: 800px; margin: 0 auto; background: white; border-radius: 20px; padding: 30px; box-shadow: 0 20px 60px rgba(0,0,0,0.3); }
        header { text-align: center; margin-bottom: 30px; }
        h1 { color: #4a5568; font-size: 2.5rem; margin-bottom: 10px; }
        .subtitle { color: #718096; font-size: 1.2rem; }
        .upload-area { border: 3px dashed #cbd5e0; border-radius: 15px; padding: 40px; text-align: center; margin: 30px 0; transition: all 0.3s; cursor: pointer; }
        .upload-area:hover { border-color: #667eea; background: #f7fafc; }
        .upload-icon { font-size: 48px; color: #a0aec0; margin-bottom: 15px; }
        .file-input { display: none; }
        .btn { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; padding: 15px 30px; border-radius: 10px; font-size: 1.1rem; cursor: pointer; transition: transform 0.2s; margin: 10px; }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 10px 20px rgba(0,0,0,0.2); }
        .result { display: none; background: #f7fafc; border-radius: 15px; padding: 25px; margin-top: 30px; border-right: 5px solid #667eea; }
        .prediction { font-size: 2rem; color: #2d3748; font-weight: bold; margin: 15px 0; }
        .confidence { color: #4caf50; font-weight: bold; font-size: 1.3rem; }
        .loading { display: none; text-align: center; margin: 20px 0; }
        .spinner { border: 5px solid #f3f3f3; border-top: 5px solid #667eea; border-radius: 50%; width: 50px; height: 50px; animation: spin 1s linear infinite; margin: 0 auto; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        footer { text-align: center; margin-top: 40px; color: #718096; font-size: 0.9rem; }
        .tip { background: #e6fffa; border-right: 4px solid #38b2ac; padding: 15px; border-radius: 8px; margin: 20px 0; }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ¨ Ù…ØµÙ†Ù Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ù…ØªÙ‚Ø¯Ù…</h1>
            <p class="subtitle">Ù†Ø³Ø®Ø© Ù…Ø­Ø³Ù†Ø© ØªØ¯Ø¹Ù… 15 Ù„ÙˆÙ†Ø§Ù‹ Ø£Ø³Ø§Ø³ÙŠØ§Ù‹</p>
        </header>

        <div class="tip">
            <strong>ğŸ’¡ ÙƒÙŠÙÙŠØ© Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…:</strong>
            <ol>
                <li>Ø§Ø®ØªØ± ØµÙˆØ±Ø© ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ù„ÙˆÙ† Ø£Ø³Ø§Ø³ÙŠ</li>
                <li>Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø³ÙŠØªØ¹Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ</li>
                <li>Ø§Ø³ØªØ®Ø¯Ù… Ù„Ù„Ø£Ø¹Ù…Ø§Ù„ Ø§Ù„ÙÙ†ÙŠØ© Ø£Ùˆ Ø§Ù„ØªØµÙ…ÙŠÙ…</li>
            </ol>
        </div>

        <div class="upload-area" id="uploadArea">
            <div class="upload-icon">ğŸ“</div>
            <h3>Ø§Ø³Ø­Ø¨ ÙˆØ£ÙÙ„Øª ØµÙˆØ±Ø© Ù‡Ù†Ø§</h3>
            <p>Ø£Ùˆ Ø§Ø¶ØºØ· Ù„Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù</p>
            <p><small>Ø§Ù„Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ù…Ø³Ù…ÙˆØ­Ø©: PNG, JPG, GIF, BMP</small></p>
            <input type="file" id="fileInput" class="file-input" accept="image/*">
        </div>

        <div style="text-align: center;">
            <button class="btn" onclick="document.getElementById('fileInput').click()">ğŸ“¤ Ø§Ø®ØªØ± ØµÙˆØ±Ø©</button>
            <button class="btn" onclick="clearResults()">ğŸ—‘ï¸ Ù…Ø³Ø­ Ø§Ù„Ù†ØªØ§Ø¦Ø¬</button>
        </div>

        <div class="loading" id="loading">
            <div class="spinner"></div>
            <p>Ø¬Ø§Ø±ÙŠ ØªØ­Ù„ÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø©...</p>
        </div>

        <div class="result" id="result">
            <h2>ğŸ“Š Ù†ØªÙŠØ¬Ø© Ø§Ù„ØªØ­Ù„ÙŠÙ„</h2>
            <div id="resultContent"></div>
        </div>

        <footer>
            <p>ØªÙ… Ø§Ù„ØªØ·ÙˆÙŠØ± Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… TensorFlow Ùˆ Flask</p>
            <p>ğŸŒ± Ø£ÙˆÙ„ Ù†Ù…ÙˆØ°Ø¬ Ø°ÙƒØ§Ø¡ Ø§ØµØ·Ù†Ø§Ø¹ÙŠ - Ø§Ù„Ø¯Ù‚Ø©: 99.1%</p>
        </footer>
    </div>

    <script>
        const uploadArea = document.getElementById('uploadArea');
        const fileInput = document.getElementById('fileInput');
        const resultDiv = document.getElementById('result');
        const resultContent = document.getElementById('resultContent');
        const loadingDiv = document.getElementById('loading');

        // Ø³Ø­Ø¨ ÙˆØ¥ÙÙ„Ø§Øª
        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.style.borderColor = '#667eea';
            uploadArea.style.background = '#f7fafc';
        });

        uploadArea.addEventListener('dragleave', () => {
            uploadArea.style.borderColor = '#cbd5e0';
            uploadArea.style.background = '';
        });

        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.style.borderColor = '#cbd5e0';
            uploadArea.style.background = '';
            
            if (e.dataTransfer.files.length) {
                fileInput.files = e.dataTransfer.files;
                uploadFile();
            }
        });

        // Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù
        fileInput.addEventListener('change', uploadFile);

        // Ø±ÙØ¹ Ø§Ù„Ù…Ù„Ù
        async function uploadFile() {
            const file = fileInput.files[0];
            if (!file) return;

            // Ø¥Ø¸Ù‡Ø§Ø± Ø­Ø§Ù„Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„
            loadingDiv.style.display = 'block';
            resultDiv.style.display = 'none';

            const formData = new FormData();
            formData.append('file', file);

            try {
                console.log('ğŸ“¤ Ø¬Ø§Ø±ÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØµÙˆØ±Ø©...');
                const response = await fetch('/upload', {
                    method: 'POST',
                    body: formData
                });

                console.log('ğŸ“¥ ØªÙ… Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…ØŒ Ø§Ù„Ø­Ø§Ù„Ø©:', response.status);
                const data = await response.json();
                console.log('ğŸ“Š Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªÙ„Ù…Ø©:', data);

                loadingDiv.style.display = 'none';

                if (data.error) {
                    resultContent.innerHTML = `<div style="color: #e53e3e; background: #fed7d7; padding: 15px; border-radius: 10px;">
                        <strong>âŒ Ø®Ø·Ø£:</strong> ${data.error}
                    </div>`;
                    resultDiv.style.display = 'block';
                    return;
                }

                // Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
                displayResults(data);
                
            } catch (error) {
                loadingDiv.style.display = 'none';
                console.error('âŒ Ø®Ø·Ø£ ÙƒØ§Ù…Ù„:', error);
                resultContent.innerHTML = `<div style="color: #e53e3e; background: #fed7d7; padding: 15px; border-radius: 10px;">
                    <strong>âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„:</strong> ${error.message}
                </div>`;
                resultDiv.style.display = 'block';
            }
        }

        // Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
        function displayResults(data) {
            const confidencePercent = data.confidence_percent || (data.confidence * 100).toFixed(1);
            
            const html = `
                <div style="text-align: center; padding: 20px;">
                    <div style="font-size: 3rem; margin: 20px 0;">ğŸ¯</div>
                    <div style="font-size: 2rem; color: #2d3748; font-weight: bold; margin: 15px 0;">
                        ${data.prediction}
                    </div>
                    <div style="font-size: 1.5rem; color: #4caf50; font-weight: bold; margin: 10px 0;">
                        Ø§Ù„Ø¯Ù‚Ø©: ${confidencePercent}%
                    </div>
                    <div style="margin-top: 20px; color: #718096;">
                        <strong>Ø§Ù„Ù…Ù„Ù:</strong> ${data.filename}
                    </div>
                </div>
            `;
            
            resultContent.innerHTML = html;
            resultDiv.style.display = 'block';
        }

        // Ù…Ø³Ø­ Ø§Ù„Ù†ØªØ§Ø¦Ø¬
        function clearResults() {
            fileInput.value = '';
            resultDiv.style.display = 'none';
            resultContent.innerHTML = '';
        }

        console.log('ğŸš€ JavaScript Ø¬Ø§Ù‡Ø² Ù„Ù„Ø¹Ù…Ù„!');
    </script>
</body>
</html>